# -*- coding: utf-8 -*-
"""
Created on Thu Feb 12 21:40:04 2015

@author: plane
"""

import numpy as np
import matplotlib.pyplot as plt  # Matplotlib's pyplot: MATLAB-like syntax
from curve import polynomial, fit_polynomial
from labview import load_csv_data

plt.figure(1)

"""
directory = "C:\\Users\\plane\\Desktop\\COMSOL\\Analysis\\RF Hammer\\"
filename = "RF_hammer_36MV-M_500us.csv"
(times_array_lv, samples_lv) = load_csv_data(directory, filename)
last_time = times_array_lv[0,0]
times_lv = (times_array_lv[0] - last_time) * 1.0e6
"""
signal_0 = np.array((-0.04428571,-0.04428571,-0.04086429,-0.04086429,-0.03231075,-0.03060004,-0.03231075,-0.02546792,-0.01862508,-0.01007154,-0.01349296,-0.01178225,-0.008360831,-0.008360831,0.005324837,0.03098546,0.06006751,0.0977031,0.133628,0.1678421,0.2003456,0.2174527,0.2277169,0.2379812,0.2260062,0.2140313,0.1952135,0.1678421,0.1353387,0.09599239,0.06691034,0.03611759,0.01387838,-0.008360831,-0.0220465,-0.04086429,-0.03915358,-0.05283925,-0.06652492,-0.06823563,-0.06823563,-0.06139279,-0.05797138,-0.05797138,-0.05626067,-0.04086429,-0.042575,-0.03744288,-0.01178225,-0.004939414,0.003614129,0.02927476,0.04124972,0.04809255,0.0583568,0.05151397,0.0583568,0.06006751,0.05493538,0.04124972,0.03953901,0.02414263,0.00190342,-0.02888933,-0.04941783,-0.1024498,-0.1417961,-0.1725888,-0.2033816,-0.2324636,-0.2564136,-0.2615457,-0.2564136,-0.2427279,-0.2307529,-0.2221994,-0.2050923,-0.1948281,-0.1725888,-0.1640353,-0.1571925,-0.1520603,-0.1486389,-0.136664,-0.1161355,-0.1024498,-0.08534271,-0.06481421,-0.04770713,-0.02717862,-0.01178225,1.927116E-4,-0.001517997,-0.008360831,-0.01691437,-0.01178225,-0.004939414,-0.02546792,-0.01862508,-0.02546792,-0.03915358,-0.042575,-0.06139279,-0.07165704,-0.06994634,-0.07678917,-0.07849988,-0.06994634,-0.05283925,-0.04428571,-0.02717862,-0.01007154,0.01216767,0.0378283,0.0378283,0.06006751,0.09086026,0.0994138,0.1165209,0.1404708,0.1695529,0.1900814,0.2260062,0.2431133,0.256799,0.2721954,0.2756168,0.2756168,0.2773275,0.2550883,0.2225848,0.203767,0.1832385,0.1473136,0.121653,0.09257097,0.0583568,0.01558909,-0.01349296,-0.05454996,-0.08876413,-0.1144248,-0.1315318,-0.1486389,-0.1332426,-0.124689,-0.1212676,-0.1144248,-0.09389626,-0.06823563,-0.04599642,-0.008360831,0.02414263,0.05493538,0.08572814,0.1096781,0.1233637,0.1456029,0.1456029,0.1421815,0.1438922,0.1473136,0.1387601,0.1113888,0.0977031,0.09257097,0.07546388,0.06348893,0.04467113,0.02756405,0.01045696,-0.004939414,-0.03744288,-0.03744288,-0.06823563,-0.0819213,-0.09560696,-0.09560696,-0.09731767,-0.1075819,-0.1161355,-0.1058712,-0.08534271,-0.07165704,-0.05112854,-0.03060004,-0.01691437,0.005324837,0.02585334,0.04467113,0.06691034,0.08401743,0.0977031,0.1096781,0.1062566,0.08743884,0.07204247,0.0583568,0.04638184,0.04809255,0.03611759,0.02072121,0.0190105,0.00190342,-0.01349296,-0.02375721,-0.05968209,-0.07678917,-0.09560696,-0.1263997,-0.1623246,-0.2050923,-0.2324636,-0.2529921,-0.2547029,-0.2529921,-0.2375958,-0.2256208,-0.1965388,-0.1589032,-0.1263997,-0.1075819,-0.08021059,-0.05112854,-0.03060004,-0.02033579,-0.01349296,-0.01520366,-0.01349296,-0.003228705,0.007035546,0.01387838,0.005324837,0.007035546,0.01216767,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0))
signal_1 = np.array((-0.1658718,-0.1658718,-0.1402763,-0.1044425,-0.06860874,-0.03960045,-0.01229853,0.004765175,0.02524162,0.03718621,0.04230532,0.07472635,0.1344493,0.2027041,0.3153245,0.4586596,0.5883437,0.7129087,0.8408865,0.9449751,1.009817,0.9944598,0.8989031,0.7948145,0.6668367,0.4740169,0.2829035,0.08837731,-0.1300381,-0.3399216,-0.5600433,-0.7579822,-0.9064364,-1.06001,-1.21017,-1.276719,-1.281838,-1.208464,-1.049772,-0.8228243,-0.5156777,-0.1880546,0.1395684,0.4450086,0.7350916,0.9705706,1.141208,1.233352,1.28113,1.282836,1.211169,1.084897,0.9142604,0.6941387,0.4296513,0.1310366,-0.17611,-0.4866694,-0.7528631,-1.007112,-1.242591,-1.420054,-1.551444,-1.611167,-1.606048,-1.578746,-1.490015,-1.358624,-1.194813,-0.9866358,-0.7631013,-0.5498051,-0.3211515,-0.1129744,0.06790087,0.2624271,0.4211195,0.5303271,0.649773,0.709496,0.7180279,0.7129087,0.649773,0.5763991,0.506438,0.3579838,0.2112359,0.09008368,-0.0140049,-0.1266253,-0.222182,-0.3057942,-0.3365088,-0.3518662,-0.3296834,-0.2614286,-0.1488081,-0.04983867,0.05936902,0.183934,0.3238564,0.4364768,0.5473908,0.6395348,0.6924323,0.6839004,0.6190584,0.538859,0.4262386,0.2777844,0.119092,-0.04983867,-0.2068247,-0.3348025,-0.4576611,-0.5139713,-0.5173841,-0.4832567,-0.4013509,-0.2853177,-0.1641655,0.02182888,0.2590143,0.492787,0.7333852,0.9227923,1.064421,1.161684,1.18216,1.136089,0.9876343,0.7726317,0.5132634,0.2641334,-0.01912401,-0.3296834,-0.609528,-0.8450071,-1.070248,-1.263068,-1.387633,-1.471245,-1.476364,-1.435411,-1.377395,-1.25283,-1.056597,-0.8040542,-0.5412732,-0.2631349,0.03547984,0.3153245,0.5815182,0.7811635,0.9756897,1.132676,1.219701,1.235058,1.219701,1.183867,1.119025,0.9910471,0.8425929,0.695845,0.5508036,0.3648093,0.183934,0.08155183,-0.04471956,-0.1658718,-0.281905,-0.3859936,-0.4423038,-0.4764312,-0.4917885,-0.4730184,-0.4167082,-0.3296834,-0.1965865,-0.008885785,0.1600448,0.2863162,0.3443328,0.3750475,0.4501278,0.4757233,0.4688978,0.4262386,0.3426264,0.2453634,0.1071474,-0.03277497,-0.1266253,-0.2051183,-0.3177388,-0.4098827,-0.4747248,-0.5276223,-0.5242095,-0.4593675,-0.4030573,-0.2938496,-0.1846419,-0.09591066,-3.539352E-4,0.0491308,0.06107539,0.0832582,0.07813909,-0.02083038,-0.111268,-0.1863483,-0.3245642,-0.4952012,-0.6607191,-0.7955224,-0.8757218,-0.9576275,-1.0037,-1.000287,-0.9439766,-0.918381,-0.8501262,-0.7084975,-0.5463923,-0.327977,-0.1300381,0.08155183,0.3067927,0.4671915,0.5985819,0.7623935,0.9227923,1.043945,1.139501,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0))
signal_2 = np.array((-0.03590987,-0.04277306,-0.04620465,-0.05306783,-0.0650784,-0.05478363,-0.06164681,-0.06164681,-0.07022579,-0.0667942,-0.0650784,-0.06336261,-0.06336261,-0.05649942,-0.05478363,-0.04448885,-0.03590987,-0.03762567,-0.02733089,-0.02733089,-0.02046771,-0.01875192,-0.01360453,-0.01703612,-0.01188873,-0.01188873,-0.01360453,-0.00845714,-0.01360453,-0.02218351,-0.0238993,-0.03076249,-0.0256151,-0.02904669,-0.01188873,-0.005025549,0.003553431,0.005269226,0.02242718,0.02585878,0.04644833,0.06017469,0.08248004,0.099638,0.108217,0.1322381,0.1356697,0.1442487,0.1579751,0.1631224,0.166554,0.1648382,0.1631224,0.1545435,0.1476803,0.1322381,0.1236591,0.108217,0.09449061,0.08248004,0.06360628,0.04644833,0.02414298,0.01384821,-0.01360453,-0.03934147,-0.05478363,-0.07537318,-0.08223636,-0.09081534,-0.1199839,-0.1216997,-0.1234155,-0.1234155,-0.1302786,-0.1199839,-0.1079733,-0.09424693,-0.08223636,-0.06336261,-0.04963624,-0.02733089,-0.01360453,-0.001593957,0.01384821,0.02929037,0.02929037,0.03786935,0.03615355,0.03443776,0.04473253,0.05502731,0.0584589,0.0584589,0.07218526,0.08934322,0.09105902,0.08419583,0.08934322,0.0979222,0.09277481,0.09449061,0.09449061,0.09105902,0.08419583,0.07390106,0.05331151,0.06017469,0.03786935,0.03443776,0.02242718,0.01384821,0.008700818,0.01041661,0.003553431,1.218389E-4,0.001837635,0.001837635,0.01384821,0.003553431,0.005269226,1.218389E-4,-0.005025549,-0.01188873,-0.01875192,-0.01703612,-0.03247828,-0.03762567,-0.05821522,-0.07537318,-0.08738375,-0.1199839,-0.1388576,-0.1422892,-0.1645946,-0.1851841,-0.1920473,-0.1903315,-0.1971947,-0.1989105,-0.1868999,-0.1766051,-0.1594472,-0.1405734,-0.1234155,-0.1028259,-0.08909954,-0.07537318,-0.04620465,-0.01875192,-0.01188873,0.003553431,0.0172798,0.02757457,0.03272196,0.03786935,0.04816412,0.06532208,0.07046947,0.06017469,0.07733265,0.08419583,0.09277481,0.09620641,0.09277481,0.1030696,0.1013538,0.08762743,0.08248004,0.07561686,0.07218526,0.05331151,0.05331151,0.04644833,0.04301673,0.03100616,0.0172798,0.01213241,-0.00845714,-0.0238993,-0.03419408,-0.02733089,-0.0256151,-0.04792044,-0.04448885,-0.04620465,-0.06164681,-0.05478363,-0.05993102,-0.05993102,-0.05821522,-0.06336261,-0.0650784,-0.0650784,-0.08223636,-0.08909954,-0.07880477,-0.08738375,-0.07708897,-0.06336261,-0.05649942,-0.05306783,-0.04105726,-0.03934147,-0.02904669,-0.01017294,0.001837635,0.01899559,0.03615355,0.04644833,0.05159571,0.05159571,0.06017469,0.06189049,0.06532208,0.0584589,0.06875367,0.06189049,0.04644833,0.03786935,0.03615355,0.03786935,0.03443776,0.03272196,0.03786935,0.04473253,0.04301673,0.05331151,0.06703788,0.07904845,0.09277481,0.0979222,0.1133644,0.1305223,0.1459645,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0))
samples_lv = np.array((signal_0, signal_2, signal_0, signal_0, signal_0, signal_1))

# domain = np.linspace(0.0, 10.0, num=50)
times = np.arange(0,202,2)
times_lv = times
samples = \
np.array(((2.5699858E-6,2.5699858E-6,3.8281254E-5,2.8642153E-4,0.0014479962,0.005585585,0.01748832,0.04585886,0.10206133,0.19306873,0.30772594,0.40325284,0.40725055,0.24876478,-0.08565372,-0.4994516,-0.77735305,-0.6456331,0.11073677,1.5257907,3.393898,5.3206925,6.870184,7.730768,7.802135,7.1533227,5.892284,4.052743,1.5920025,-1.4899402,-4.9934707,-8.445366,-11.182977,-12.573381,-12.256845,-10.285013,-7.0870123,-3.298576,0.4398722,3.6163318,5.881019,7.023097,6.954305,5.7277927,3.5676413,0.8617719,-1.9067247,-4.270736,-5.8846316,-6.5816407,-6.371802,-5.400368,-3.8973756,-2.1377466,-0.4116924,1.006305,1.8980865,2.146885,1.7702256,0.92292154,-0.13725898,-1.1131434,-1.7407203,-1.8478842,-1.3838362,-0.4162082,0.89579386,2.3389626,3.6831248,4.7122974,5.250017,5.180813,4.4681435,3.166036,1.4196945,-0.54893935,-2.4714255,-4.075053,-5.1291604,-5.485574,-5.1040792,-4.05759,-2.5170932,-0.7215244,1.0595711,2.5632417,3.5657825,3.909678,3.5250862,2.4449105,0.8098386,-1.1419585,-3.1042907,-4.750388,-5.790426,-6.0260577,-5.3879933,-3.9468646,-1.8953906,0.49206832,2.9110992),
(-2.7860395E-4,-2.7860395E-4,-0.0031466533,-0.0167598,-0.055499908,-0.1265717,-0.20663287,-0.23772001,-0.1636011,0.021169843,0.25731292,0.4456725,0.47952306,0.28084064,-0.1401595,-0.6267882,-0.8889684,-0.6188191,0.35124478,1.9483155,3.8702724,5.6905017,7.0058274,7.573243,7.372448,6.545017,5.2363963,3.4590182,1.1024269,-1.8928877,-5.321526,-8.632848,-11.0745,-11.996874,-11.143887,-8.760532,-5.463801,-1.9705191,1.14836,3.5626297,5.1259766,5.76859,5.4482183,4.1922765,2.176301,-0.24582608,-2.6045692,-4.446439,-5.466555,-5.579219,-4.9053454,-3.7002842,-2.2659843,-0.88256466,0.22946845,0.9246077,1.1384995,0.8911125,0.2841173,-0.51360744,-1.294655,-1.8515238,-2.0158079,-1.6892844,-0.861801,0.38493168,1.8864936,3.4170353,4.722388,5.5630107,5.7605276,5.2372026,4.0367107,2.3187852,0.3284027,-1.6517826,-3.352683,-4.5614953,-5.1484175,-5.075791,-4.392666,-3.2199504,-1.7310838,-0.131505,1.3620387,2.5429788,3.2381647,3.3323808,2.7909439,1.6745632,0.13983636,-1.5790492,-3.2068598,-4.4755015,-5.172662,-5.178736,-4.4831448,-3.1774917,-1.429882,0.5505516,2.5488803),
(-0.0018014429,-0.0018014429,-0.01586494,-0.06508773,-0.16367832,-0.27960256,-0.34000692,-0.3001701,-0.19293424,-0.08979452,-0.032635488,-0.019988615,-0.029794285,-0.024283538,0.05041694,0.22762097,0.46472013,0.6457535,0.6729539,0.56218463,0.4307732,0.38614345,0.43151027,0.46671006,0.3543187,-0.018125314,-0.70506334,-1.6813915,-2.827422,-3.948028,-4.8440146,-5.4035907,-5.65014,-5.7049756,-5.6799984,-5.56318,-5.1714573,-4.214309,-2.4501364,0.14290883,3.2825134,6.447836,9.075628,10.78626,11.513748,11.4657135,10.939731,10.110245,8.919523,7.143229,4.5934343,1.3346995,-2.2239628,-5.428381,-7.6261044,-8.432007,-7.8738613,-6.347715,-4.4169607,-2.5676904,-1.0445282,0.16452195,1.2113966,2.2228673,3.1841247,3.9288945,4.229494,3.9278653,3.0336666,1.7402426,0.35540456,-0.81440127,-1.5701624,-1.8710341,-1.8143929,-1.5632051,-1.260068,-0.96882814,-0.6678542,-0.29285103,0.19625624,0.7601057,1.265296,1.5192904,1.3401632,0.6305107,-0.57648796,-2.1176186,-3.7446642,-5.193452,-6.248852,-6.783246,-6.760652,-6.214467,-5.216124,-3.851443,-2.2129238,-0.40522867,1.4464756,3.196467,4.6924706)))

plt.plot(times, samples[0], times, samples[1], times, samples[2],
         times_lv[:101], 10*samples_lv[0][:101], "b.",
         times_lv[:101], 10*samples_lv[5][:101], "g.",
         times_lv[:101], 10*samples_lv[1][:101], "r.")

# plt.subplot(231)
# plt.plot(domain, fit)
plt.title('Run Times for Simulations with Select Step Sizes')
plt.xlabel('Time (us)')
plt.ylabel('Amplitude')

plt.show()